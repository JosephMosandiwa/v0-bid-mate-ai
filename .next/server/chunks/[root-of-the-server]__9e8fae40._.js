module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},482993,e=>{"use strict";var t=e.i(248749),r=e.i(219650),a=e.i(508677),n=e.i(615159),i=e.i(548938),s=e.i(273073),o=e.i(129714),l=e.i(403736),d=e.i(817889),c=e.i(428765),u=e.i(762198),p=e.i(117109),m=e.i(590702),f=e.i(462216),h=e.i(539401),x=e.i(222695),g=e.i(193695);e.i(31514);var v=e.i(267074),y=e.i(490788),R=e.i(18444);async function _(e){try{var t;let r,{documentUrl:a,tenderId:n,tenderType:i}=await e.json();console.log("[v0] Extracting form fields from document:",a);let s=await fetch(a);if(!s.ok)throw Error(`Failed to fetch document: ${s.statusText}`);let o=await s.arrayBuffer(),l=s.headers.get("content-type")||"application/pdf",d=await (0,R.processDocument)(o,l,{extract_forms:!0,extract_tables:!1,extract_images:!1,ocr_enabled:!0});if(!d.success||!d.document)throw Error(d.error?.message||"Failed to process document");let c=d.document,u=[];c.layout.form_regions.forEach(e=>{e.detected_fields.forEach(t=>{var r,a,n;let i;u.push({id:t.id,label:t.label.text,type:(r=t.input.type,a=t.suggested_type,"checkbox"===r?"checkbox":"radio"===r?"radio":"signature"===r?"file":"date"===r?"date":"email"===a?"email":"phone"===a?"tel":"number"===a||"currency"===a?"number":"date"===a?"date":"text_box"===r?"textarea":"text"),required:!1,placeholder:b(t.label.text,t.suggested_type),description:"",section:E(t.label.text),validation:(n=t.suggested_type,i={},"email"===n&&(i.pattern="^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$"),"phone"===n&&(i.pattern="^[+]?[(]?[0-9]{1,4}[)]?[-\\s\\.]?[(]?[0-9]{1,4}[)]?[-\\s\\.]?[0-9]{1,9}$"),("number"===n||"currency"===n)&&(i.min=0),Object.keys(i).length>0?i:void 0),position:{page:e.page,...t.input.position}})})}),c.form_fields.forEach(e=>{var t;let r;u.push({id:e.name||e.id,label:e.name.replace(/_/g," ").replace(/([A-Z])/g," $1").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ").trim(),type:function(e){switch(e){case"textarea":return"textarea";case"checkbox":return"checkbox";case"radio":return"radio";case"select":return"select";case"date":return"date";case"signature":return"file";default:return"text"}}(e.type),required:e.is_required,placeholder:b(e.name,"text"),description:"",section:E(e.name),validation:(t=e,r={},t.max_length&&(r.maxLength=t.max_length),t.format&&(r.pattern=t.format),Object.keys(r).length>0?r:void 0),options:e.options.map(e=>e.label),position:{page:e.page,...e.position}})});let p=(t=u,r=new Map,t.forEach(e=>{let t=e.label.toLowerCase().replace(/\s+/g,"");(!r.has(t)||e.required)&&r.set(t,e)}),Array.from(r.values())).sort((e,t)=>e.position.page!==t.position.page?e.position.page-t.position.page:Math.abs(e.position.y-t.position.y)>20?e.position.y-t.position.y:e.position.x-t.position.x),m=Array.from(new Set(p.map(e=>e.section))),f=m.map(e=>({section:e,fields:p.filter(t=>t.section===e)}));return console.log(`[v0] Extracted ${p.length} fields from ${m.length} sections`),y.NextResponse.json({success:!0,formFields:p,sections:f,document:{id:c.document_id,pageCount:c.metadata.page_count,detectedType:c.metadata.detected_type},metadata:{totalFields:p.length,requiredFields:p.filter(e=>e.required).length,sections:m.length,nativeFields:c.form_fields.length,detectedFields:c.layout.form_regions.reduce((e,t)=>e+t.detected_fields.length,0)}})}catch(e){return console.error("[v0] Error extracting form fields:",e),y.NextResponse.json({error:"Failed to extract form fields",details:e.message},{status:500})}}function b(e,t){if("date"===t)return"YYYY-MM-DD";if("email"===t)return"example@company.com";if("phone"===t)return"+27 00 000 0000";if("currency"===t)return"R 0.00";if("number"===t)return"0";let r=e.toLowerCase();return r.includes("name")?"Enter full name":r.includes("address")?"Enter complete address":r.includes("id")||r.includes("number")?"Enter ID/reference number":`Enter ${e.toLowerCase()}`}function E(e){let t=e.toLowerCase();return t.includes("company")||t.includes("business")||t.includes("organization")?"Company Information":t.includes("contact")||t.includes("email")||t.includes("phone")||t.includes("address")?"Contact Details":t.includes("price")||t.includes("cost")||t.includes("value")||t.includes("amount")?"Pricing Information":t.includes("experience")||t.includes("qualification")||t.includes("reference")?"Experience & Qualifications":t.includes("compliance")||t.includes("certificate")||t.includes("registration")?"Compliance & Certifications":t.includes("technical")||t.includes("specification")?"Technical Requirements":"General Information"}e.s(["POST",()=>_],399610);var w=e.i(399610);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/v1/documind/extract-form-fields/route",pathname:"/api/v1/documind/extract-form-fields",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/v1/documind/extract-form-fields/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:k,workUnitAsyncStorage:A,serverHooks:j}=C;function q(){return(0,a.patchFetch)({workAsyncStorage:k,workUnitAsyncStorage:A})}async function P(e,t,a){C.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/v1/documind/extract-form-fields/route";y=y.replace(/\/index$/,"")||"/";let R=await C.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:_,params:b,nextConfig:E,parsedUrl:w,isDraftMode:k,prerenderManifest:A,routerServerContext:j,isOnDemandRevalidate:q,revalidateOnlyGenerated:P,resolvedPathname:T,clientReferenceManifest:N,serverActionsManifest:O}=R,S=(0,l.normalizeAppPath)(y),M=!!(A.dynamicRoutes[S]||A.routes[T]),I=async()=>((null==j?void 0:j.render404)?await j.render404(e,t,w,!1):t.end("This page could not be found"),null);if(M&&!k){let e=!!A.routes[T],t=A.dynamicRoutes[S];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await I();throw new g.NoFallbackError}}let D=null;!M||C.isDev||k||(D="/index"===(D=T)?"/":D);let H=!0===C.isDev||!M,U=M&&!H;O&&N&&(0,s.setReferenceManifestsSingleton)({page:y,clientReferenceManifest:N,serverActionsManifest:O,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:O})});let F=e.method||"GET",$=(0,i.getTracer)(),L=$.getActiveScopeSpan(),K={params:b,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>C.onRequestError(e,t,a,j)},sharedContext:{buildId:_}},B=new d.NodeNextRequest(e),G=new d.NodeNextResponse(t),Y=c.NextRequestAdapter.fromNodeNextRequest(B,(0,c.signalFromNodeResponse)(t));try{let s=async e=>C.handle(Y,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=$.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${F} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${F} ${y}`)}),o=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var i,l;let d=async({previousCacheEntry:r})=>{try{if(!o&&q&&P&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(n);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let d=K.renderOpts.collectedTags;if(!M)return await (0,m.sendResponse)(B,G,i,K.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(i.headers);d&&(t[x.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,a=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:q})},j),t}},c=await C.handleResponse({req:e,nextConfig:E,cacheKey:D,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:q,revalidateOnlyGenerated:P,responseGenerator:d,waitUntil:a.waitUntil,isMinimalMode:o});if(!M)return null;if((null==c||null==(i=c.value)?void 0:i.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",q?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),k&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,f.fromNodeOutgoingHttpHeaders)(c.value.headers);return o&&M||u.delete(x.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,h.getCacheControlHeader)(c.cacheControl)),await (0,m.sendResponse)(B,G,new Response(c.value.body,{headers:u,status:c.value.status||200})),null};L?await l(L):await $.withPropagatedContext(e.headers,()=>$.trace(u.BaseServerSpan.handleRequest,{spanName:`${F} ${y}`,kind:i.SpanKind.SERVER,attributes:{"http.method":F,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:S,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:q})}),M)throw t;return await (0,m.sendResponse)(B,G,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>q,"routeModule",()=>C,"serverHooks",()=>j,"workAsyncStorage",()=>k,"workUnitAsyncStorage",()=>A],482993)},87683,e=>{e.v(t=>Promise.all(["server/chunks/6726b_pdf-lib_es_index_e43914b4.js","server/chunks/node_modules__pnpm_29933faf._.js"].map(t=>e.l(t))).then(()=>t(644674)))},746382,e=>{e.v(t=>Promise.all(["server/chunks/0c5e6_unpdf_dist_37260536._.js"].map(t=>e.l(t))).then(()=>t(278893)))},318896,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__3a8b8f05._.js","server/chunks/[root-of-the-server]__68a19f2b._.js"].map(t=>e.l(t))).then(()=>t(771214)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__9e8fae40._.js.map