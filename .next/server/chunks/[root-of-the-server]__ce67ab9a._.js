module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},666680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},81111,(e,t,r)=>{t.exports=e.x("node:stream",()=>require("node:stream"))},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},99348,(e,t,r)=>{t.exports=e.x("string_decoder",()=>require("string_decoder"))},687769,(e,t,r)=>{t.exports=e.x("node:events",()=>require("node:events"))},812057,(e,t,r)=>{t.exports=e.x("node:util",()=>require("node:util"))},464422,19863,291853,e=>{"use strict";let t={version:"1.0.0",requiredFields:["title","organization"],optionalFields:["tender_reference","close_date","description","category","location","estimated_value","publish_date","opening_date","contact_person","contact_email","contact_phone","submission_method","requirements","eligibility_criteria","payment_terms","contract_duration","compulsory_briefing","tender_type","procurement_category"],documentTypes:["Tender Document","Terms of Reference","Specifications","Pricing Schedule","SBD Forms","Declaration Forms","Technical Requirements","Contract Terms"],fields:[{name:"tender_reference",displayName:"Tender Reference Number",type:"string",required:!1,description:"Unique identifier for the tender",extractionHints:{aliases:["tender number","reference","tender no","ref no","reference number","tender id"],patterns:["\\b[A-Z]{2,}[\\/-]?\\d{2,}[\\/-]?\\d{2,}\\b","\\bT\\d{4,}\\b","\\b\\d{2,}\\/\\d{4}\\b"],context:["reference","tender","number","quotation"],priority:10}},{name:"title",displayName:"Tender Title",type:"string",required:!0,description:"The main title or subject of the tender",extractionHints:{aliases:["tender title","subject","project name","tender for"],patterns:[],context:["tender","project","supply","services","appointment"],priority:10}},{name:"organization",displayName:"Issuing Organization",type:"string",required:!0,description:"The organization issuing the tender",extractionHints:{aliases:["organization","department","municipality","entity","client","issuer"],patterns:[],context:["municipality","department","ministry","council"],priority:9}},{name:"description",displayName:"Description",type:"string",required:!1,description:"Detailed description of what is being procured",extractionHints:{aliases:["description","scope","scope of work","requirements","details"],patterns:[],context:["scope","required","must","shall","includes"],priority:8}},{name:"category",displayName:"Category",type:"string",required:!1,description:"The procurement category or sector",extractionHints:{aliases:["category","sector","type","classification"],patterns:[],context:["construction","it","services","goods","works"],priority:7}},{name:"location",displayName:"Location",type:"string",required:!1,description:"Physical location or province",extractionHints:{aliases:["location","province","region","area","place"],patterns:["Gauteng|Western Cape|Eastern Cape|KwaZulu-Natal|Free State|Limpopo|Mpumalanga|Northern Cape|North West"],context:["province","located","region"],priority:6}},{name:"estimated_value",displayName:"Estimated Value",type:"string",required:!1,description:"The estimated contract value",extractionHints:{aliases:["value","budget","amount","contract value","estimated cost"],patterns:["R\\s?[\\d,]+","ZAR\\s?[\\d,]+"],context:["value","budget","rand","amount"],priority:8}},{name:"publish_date",displayName:"Publish Date",type:"date",required:!1,description:"When the tender was published",extractionHints:{aliases:["publish date","publication date","advertised","issued date"],patterns:["\\d{1,2}[\\/-]\\d{1,2}[\\/-]\\d{2,4}","\\d{4}[\\/-]\\d{2}[\\/-]\\d{2}"],context:["published","advertised","issued"],priority:5}},{name:"close_date",displayName:"Closing Date",type:"date",required:!1,description:"Submission deadline",validationRules:{format:"ISO8601"},extractionHints:{aliases:["closing date","deadline","submission date","due date","closes"],patterns:["\\d{1,2}[\\/-]\\d{1,2}[\\/-]\\d{2,4}","\\d{4}[\\/-]\\d{2}[\\/-]\\d{2}"],context:["closing","deadline","closes","due"],priority:10}},{name:"opening_date",displayName:"Opening Date",type:"date",required:!1,description:"When bids will be opened",extractionHints:{aliases:["opening date","bid opening","tender opening"],patterns:["\\d{1,2}[\\/-]\\d{1,2}[\\/-]\\d{2,4}","\\d{4}[\\/-]\\d{2}[\\/-]\\d{2}"],context:["opening","bids will be opened"],priority:4}},{name:"contact_person",displayName:"Contact Person",type:"string",required:!1,description:"Name of contact person",extractionHints:{aliases:["contact person","contact","enquiries","contact name"],patterns:["[A-Z][a-z]+\\s+[A-Z][a-z]+"],context:["contact","enquiries","person"],priority:5}},{name:"contact_email",displayName:"Contact Email",type:"string",required:!1,description:"Email address for enquiries",validationRules:{pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$"},extractionHints:{aliases:["email","e-mail","email address"],patterns:["[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"],context:["email","contact","enquiries"],priority:6}},{name:"contact_phone",displayName:"Contact Phone",type:"string",required:!1,description:"Phone number for enquiries",extractionHints:{aliases:["phone","telephone","tel","contact number"],patterns:["\\+?27\\s?\\d{2}\\s?\\d{3}\\s?\\d{4}","$$?0\\d{2}$$?\\s?\\d{3}\\s?\\d{4}"],context:["phone","tel","contact","call"],priority:5}},{name:"requirements",displayName:"Requirements",type:"array",required:!1,description:"List of tender requirements",extractionHints:{aliases:["requirements","mandatory requirements","prerequisites","must have"],patterns:[],context:["required","must","mandatory","compulsory"],priority:7}},{name:"eligibility_criteria",displayName:"Eligibility Criteria",type:"array",required:!1,description:"Who can bid",extractionHints:{aliases:["eligibility","eligible","who may bid","qualification criteria"],patterns:[],context:["eligible","may bid","qualified","registration"],priority:6}},{name:"compulsory_briefing",displayName:"Compulsory Briefing",type:"string",required:!1,description:"Information about mandatory briefing sessions",extractionHints:{aliases:["compulsory briefing","mandatory briefing","site visit","pre-bid meeting"],patterns:[],context:["compulsory","mandatory","briefing","meeting","site"],priority:7}},{name:"tender_type",displayName:"Tender Type",type:"string",required:!1,description:"Type of procurement (RFQ, RFP, etc)",extractionHints:{aliases:["tender type","procurement type","bid type"],patterns:["RFQ|RFP|RFI|ITB|EOI"],context:["request for","quotation","proposal"],priority:5}}]};class r{static validate(e){let r=[],n=[],i=[];for(let n of t.requiredFields)e[n]&&""!==e[n]||(r.push({field:n,message:`Required field '${n}' is missing or empty`,severity:"error"}),i.push(n));for(let r of t.optionalFields)e[r]&&""!==e[r]||(n.push(`Optional field '${r}' is missing - tender may be incomplete`),i.push(r));let a=e.contact_email;a&&!this.isValidEmail(a)&&r.push({field:"contact_email",message:"Invalid email format",severity:"warning"});let s=t.requiredFields.length+t.optionalFields.length,o=Math.round((s-i.length)/s*100);return{isValid:0===r.filter(e=>"error"===e.severity).length,score:o,errors:r,missingFields:i,warnings:n}}static isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}static getQualityScore(e){let t=this.validate(e),r=[];100===t.score?r.push("✓ All fields populated"):t.score>=80?r.push("✓ Most important fields populated"):t.score>=60?r.push("⚠ Missing some important information"):r.push("✗ Tender data is incomplete"),t.missingFields.includes("tender_reference")&&r.push("✗ Missing tender reference number"),t.missingFields.includes("close_date")&&r.push("✗ Missing closing date"),t.missingFields.includes("contact_email")&&r.push("⚠ No contact email found"),t.missingFields.includes("estimated_value")&&r.push("⚠ No tender value information");let n=t.score>=90?"A":t.score>=80?"B":t.score>=70?"C":t.score>=60?"D":"F";return{score:t.score,grade:n,feedback:r}}}e.s(["TenderValidator",()=>r],19863);class n{static getTenderSchema(){return t}static getExtractionHints(){return t.fields.map(e=>({field:e.name,displayName:e.displayName,...e.extractionHints}))}static validateTender(e){return r.validate(e)}static getTenderQuality(e){return r.getQualityScore(e)}static normalizeScrapedData(e){let r={};for(let n of t.fields){let t=e[n.name];if(!t)for(let r of n.extractionHints.aliases){let n=Object.keys(e).find(e=>e.toLowerCase()===r.toLowerCase());if(n){t=e[n];break}}t&&(r[n.name]=t)}return r}static async extractTenderFromDocument(e){console.log("[v0] TenderService: Extracting tender data from document");let r={},n=e.pages.map(e=>e.content.full_text).join("\n");for(let e of t.fields){let t=e.extractionHints;for(let i of t.patterns){let t=RegExp(i,"i"),a=n.match(t);if(a&&a[1]){r[e.name]=a[1].trim(),console.log(`[v0] TenderService: Found ${e.name}: ${r[e.name]}`);break}}if(!r[e.name])for(let i of t.context){let t=RegExp(`${i}[:\\s]+(.*?)(?:\\n|$)`,"i"),a=n.match(t);if(a&&a[1]){r[e.name]=a[1].trim(),console.log(`[v0] TenderService: Found ${e.name} via context: ${r[e.name]}`);break}}}let i=this.validateTender(r);return i.score<20?(console.warn("[v0] TenderService: Not enough tender data found in document"),null):(console.log(`[v0] TenderService: Extracted tender data with ${i.score}% completeness`),this.normalizeScrapedData(r))}static getTenderAnalysisContext(e){this.validateTender(e);let r=this.getTenderQuality(e);return`
Tender Data Quality: ${r.grade} (${r.score}%)

Available Fields:
${t.fields.map(t=>`- ${t.displayName}: ${e[t.name]?"✓":"✗"}`).join("\n")}

Data Completeness:
${r.feedback.join("\n")}

This context helps you understand what information is available for analysis.
    `.trim()}}function i(e){return n.validateTender(e)}function a(e){return n.normalizeScrapedData(e)}e.s(["TenderService",()=>n],291853),e.s(["normalizeTenderData",()=>a,"validateTender",()=>i],464422)},951615,(e,t,r)=>{t.exports=e.x("node:buffer",()=>require("node:buffer"))},478500,(e,t,r)=>{t.exports=e.x("node:async_hooks",()=>require("node:async_hooks"))},609737,e=>{"use strict";var t=e.i(248749),r=e.i(219650),n=e.i(508677),i=e.i(615159),a=e.i(548938),s=e.i(273073),o=e.i(129714),l=e.i(403736),d=e.i(817889),c=e.i(428765),u=e.i(762198),p=e.i(117109),m=e.i(590702),g=e.i(462216),y=e.i(539401),f=e.i(222695),h=e.i(193695);e.i(31514);var x=e.i(267074),v=e.i(351278),b=e.i(252736);async function _(){let e=(0,b.createClient)("https://xqyecqkrtaydoesxnvlw.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);console.log("[DEBUG] Starting debug scrape with NO validation");let{data:t}=await e.from("tender_sources").select("*").eq("is_active",!0).eq("scraping_enabled",!0).limit(1).single();if(!t)return Response.json({error:"No active sources found"},{status:404});console.log(`[DEBUG] Scraping source: ${t.name}`);let r=v.ScraperFactory.createScraper(t),n=await r.scrape();if(console.log(`[DEBUG] Scraper found ${n.tenders?.length||0} tenders`),!n.success||!n.tenders||0===n.tenders.length)return Response.json({success:!1,message:"Scraper found 0 tenders",sourceName:t.name,sourceUrl:t.tender_page_url});let i=n.tenders.map(e=>({source_id:t.id,source_name:t.name,source_url:t.tender_page_url,source_level:t.level,source_province:t.province,title:e.title||"NO TITLE",description:e.description||null,tender_reference:e.tender_reference||null,tender_url:e.tender_url||t.tender_page_url,close_date:e.close_date||null,publish_date:e.publish_date||null,organization:e.organization||t.name,location:e.location||t.province,estimated_value:e.estimated_value||null,category:e.category||null,contact_name:e.contact_name||null,contact_email:e.contact_email||null,contact_phone:e.contact_phone||null,requirements:e.requirements||null,document_urls:e.document_urls||[],is_active:!0,quality_score:0,quality_grade:"DEBUG"}));console.log(`[DEBUG] Saving ${i.length} tenders WITHOUT validation`);let{data:a,error:s}=await e.from("scraped_tenders").insert(i).select();return s?(console.error("[DEBUG] Error saving:",s),Response.json({success:!1,error:s.message,sampleTender:i[0]},{status:500})):(console.log(`[DEBUG] Successfully saved ${a?.length||0} tenders`),Response.json({success:!0,message:`Saved ${a?.length} tenders from ${t.name}`,tenders:a}))}e.s(["POST",()=>_],76754);var R=e.i(76754);let q=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/scraping/debug/route",pathname:"/api/scraping/debug",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/scraping/debug/route.ts",nextConfigOutput:"",userland:R}),{workAsyncStorage:E,workUnitAsyncStorage:T,serverHooks:w}=q;function N(){return(0,n.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:T})}async function C(e,t,n){q.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/scraping/debug/route";v=v.replace(/\/index$/,"")||"/";let b=await q.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!b)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:_,params:R,nextConfig:E,parsedUrl:T,isDraftMode:w,prerenderManifest:N,routerServerContext:C,isOnDemandRevalidate:S,revalidateOnlyGenerated:A,resolvedPathname:H,clientReferenceManifest:D,serverActionsManifest:$}=b,P=(0,l.normalizeAppPath)(v),F=!!(N.dynamicRoutes[P]||N.routes[H]),O=async()=>((null==C?void 0:C.render404)?await C.render404(e,t,T,!1):t.end("This page could not be found"),null);if(F&&!w){let e=!!N.routes[H],t=N.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await O();throw new h.NoFallbackError}}let k=null;!F||q.isDev||w||(k="/index"===(k=H)?"/":k);let j=!0===q.isDev||!F,U=F&&!j;$&&D&&(0,s.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:D,serverActionsManifest:$,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:$})});let I=e.method||"GET",M=(0,a.getTracer)(),z=M.getActiveScopeSpan(),B={params:R,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>q.onRequestError(e,t,n,C)},sharedContext:{buildId:_}},L=new d.NodeNextRequest(e),G=new d.NodeNextResponse(t),K=c.NextRequestAdapter.fromNodeNextRequest(L,(0,c.signalFromNodeResponse)(t));try{let s=async e=>q.handle(K,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=M.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${I} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${I} ${v}`)}),o=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var a,l;let d=async({previousCacheEntry:r})=>{try{if(!o&&S&&A&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await s(i);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let d=B.renderOpts.collectedTags;if(!F)return await (0,m.sendResponse)(L,G,a,B.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(a.headers);d&&(t[f.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,n=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await q.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:S})},C),t}},c=await q.handleResponse({req:e,nextConfig:E,cacheKey:k,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:A,responseGenerator:d,waitUntil:n.waitUntil,isMinimalMode:o});if(!F)return null;if((null==c||null==(a=c.value)?void 0:a.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",S?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),w&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,g.fromNodeOutgoingHttpHeaders)(c.value.headers);return o&&F||u.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,y.getCacheControlHeader)(c.cacheControl)),await (0,m.sendResponse)(L,G,new Response(c.value.body,{headers:u,status:c.value.status||200})),null};z?await l(z):await M.withPropagatedContext(e.headers,()=>M.trace(u.BaseServerSpan.handleRequest,{spanName:`${I} ${v}`,kind:a.SpanKind.SERVER,attributes:{"http.method":I,"http.target":e.url}},l))}catch(t){if(t instanceof h.NoFallbackError||await q.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:S})}),F)throw t;return await (0,m.sendResponse)(L,G,new Response(null,{status:500})),null}}e.s(["handler",()=>C,"patchFetch",()=>N,"routeModule",()=>q,"serverHooks",()=>w,"workAsyncStorage",()=>E,"workUnitAsyncStorage",()=>T],609737)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ce67ab9a._.js.map