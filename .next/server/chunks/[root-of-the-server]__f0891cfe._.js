module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},89660,e=>{"use strict";e.i(929961);var t=e.i(771884),r=e.i(875216);async function a(){let e=await (0,r.cookies)();return(0,t.createServerClient)("https://xqyecqkrtaydoesxnvlw.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhxeWVjcWtydGF5ZG9lc3hudmx3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzMjM0NTgsImV4cCI6MjA3Njg5OTQ1OH0.wsb5Jz_I9RqxoNoZ6D3QPbK4aefbdGKcrGgWDfm3c4o",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:a})=>e.set(t,r,a))}catch{}}}})}e.s(["createClient",()=>a,"createServerClient",0,a])},773939,(e,t,r)=>{"use strict";var a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,o={},l={VercelOidcTokenError:()=>d};for(var c in l)a(o,c,{get:l[c],enumerable:!0});t.exports=((e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of i(t))s.call(e,r)||void 0===r||a(e,r,{get:()=>t[r],enumerable:!(o=n(t,r))||o.enumerable});return e})(a({},"__esModule",{value:!0}),o);class d extends Error{constructor(e,t){super(e),this.name="VercelOidcTokenError",this.cause=t}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},682282,e=>{"use strict";var t=e.i(248749),r=e.i(219650),a=e.i(508677),n=e.i(615159),i=e.i(548938),s=e.i(273073),o=e.i(129714),l=e.i(403736),c=e.i(817889),d=e.i(428765),u=e.i(762198),p=e.i(117109),g=e.i(590702),m=e.i(462216),h=e.i(539401),f=e.i(222695),y=e.i(193695);e.i(31514);var v=e.i(267074),_=e.i(303826),x=e.i(89660),R=e.i(490788);async function b(e,{params:t}){try{let e,{id:r}=await t,a=await (0,x.createClient)(),{data:{user:n},error:i}=await a.auth.getUser();if(i||!n)return R.NextResponse.json({error:"Unauthorized"},{status:401});let{data:s,error:o}=await a.from("user_custom_tender_analysis").select("analysis_data").eq("tender_id",r).single();if(o||!s)return R.NextResponse.json({error:"No analysis found for this tender"},{status:404});let l=s.analysis_data,c={tender_summary:l.tender_summary||{},evaluation:l.evaluation||{},financial_requirements:l.financial_requirements||{},legal_registration:l.legal_registration||{},labour_employment:l.labour_employment||{},technical_specs:l.technical_specs||{},penalties_payment:l.penalties_payment||{},compliance_summary:l.compliance_summary||{},risk_assessment:l.risk_assessment||{},bbbee_analysis:l.bbbee_analysis||{}},d=`You are an expert South African tender strategist and negotiation consultant with 20+ years of experience in government and private sector procurement. You specialize in helping businesses maximize their chances of winning tenders while protecting their interests.

Your role is to analyze tender requirements and generate actionable negotiation strategies that:
1. Identify leverage points and areas for clarification
2. Highlight potential risks and how to address them
3. Suggest ways to differentiate from competitors
4. Recommend pricing strategies based on the evaluation criteria
5. Advise on B-BBEE optimization tactics

Be specific, practical, and focused on South African procurement context. Reference specific tender requirements when making recommendations.`,u=`Based on the following tender analysis, generate a comprehensive 5-point negotiation strategy:

## TENDER CONTEXT:
${JSON.stringify(c,null,2)}

## REQUIRED OUTPUT FORMAT:
Generate a JSON object with this exact structure:
{
  "strategy_title": "Strategic title for this negotiation approach",
  "overall_approach": "2-3 sentence summary of the recommended negotiation stance",
  "win_probability_assessment": {
    "score": <number 1-100>,
    "reasoning": "Why this score was assigned"
  },
  "negotiation_points": [
    {
      "point_number": 1,
      "title": "Clear, actionable title",
      "category": "Pricing|Technical|Compliance|Risk Mitigation|B-BBEE",
      "priority": "Critical|High|Medium",
      "challenge": "What specific challenge or opportunity this addresses",
      "strategy": "Detailed strategy (2-3 sentences)",
      "talking_points": ["Specific point 1", "Specific point 2", "Specific point 3"],
      "expected_outcome": "What you should achieve"
    }
  ],
  "pricing_recommendations": {
    "approach": "Cost-plus|Competitive|Value-based|Premium",
    "rationale": "Why this approach suits this tender",
    "margin_guidance": "Suggested margin range and reasoning",
    "risk_pricing": "How to price in identified risks"
  },
  "bbbee_optimization": {
    "current_potential": "Assessment of B-BBEE scoring potential",
    "quick_wins": ["Immediate actions to boost B-BBEE score"],
    "subcontracting_strategy": "How to leverage 30% EME/QSE subcontracting if applicable"
  },
  "clarification_questions": [
    "Specific questions to ask during the clarification period"
  ],
  "red_flags": [
    {
      "issue": "Potential problem identified",
      "recommendation": "How to address or protect against this"
    }
  ],
  "timeline_recommendations": {
    "preparation_days_needed": <number>,
    "key_milestones": ["Milestone 1 with date guidance", "Milestone 2"]
  }
}

Return ONLY the JSON object, no markdown formatting or additional text.`;console.log("[v0] Generating negotiation strategy for tender:",r);let{text:p}=await (0,_.default)({model:"openai/gpt-4o",system:d,prompt:u,temperature:.7,maxTokens:4e3});try{let t=p.trim();t.startsWith("```json")?t=t.slice(7):t.startsWith("```")&&(t=t.slice(3)),t.endsWith("```")&&(t=t.slice(0,-3)),t=t.trim(),e=JSON.parse(t)}catch(e){return console.error("[v0] Failed to parse strategy response:",e),R.NextResponse.json({error:"Failed to parse strategy response",raw:p},{status:500})}let{error:g}=await a.from("user_custom_tender_analysis").update({analysis_data:{...l,negotiation_strategy:e,strategy_generated_at:new Date().toISOString()}}).eq("tender_id",r);return g&&console.error("[v0] Failed to save strategy:",g),R.NextResponse.json({success:!0,strategy:e})}catch(e){return console.error("[v0] Negotiation strategy generation error:",e),R.NextResponse.json({error:"Failed to generate negotiation strategy",details:e.message},{status:500})}}e.s(["POST",()=>b],322360);var w=e.i(322360);let E=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/custom-tenders/[id]/negotiation-strategy/route",pathname:"/api/custom-tenders/[id]/negotiation-strategy",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/custom-tenders/[id]/negotiation-strategy/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:C,workUnitAsyncStorage:O,serverHooks:N}=E;function k(){return(0,a.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:O})}async function S(e,t,a){E.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let _="/api/custom-tenders/[id]/negotiation-strategy/route";_=_.replace(/\/index$/,"")||"/";let x=await E.prepare(e,t,{srcPage:_,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:R,params:b,nextConfig:w,parsedUrl:C,isDraftMode:O,prerenderManifest:N,routerServerContext:k,isOnDemandRevalidate:S,revalidateOnlyGenerated:j,resolvedPathname:A,clientReferenceManifest:T,serverActionsManifest:I}=x,P=(0,l.normalizeAppPath)(_),q=!!(N.dynamicRoutes[P]||N.routes[A]),M=async()=>((null==k?void 0:k.render404)?await k.render404(e,t,C,!1):t.end("This page could not be found"),null);if(q&&!O){let e=!!N.routes[A],t=N.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await M();throw new y.NoFallbackError}}let H=null;!q||E.isDev||O||(H="/index"===(H=A)?"/":H);let U=!0===E.isDev||!q,B=q&&!U;I&&T&&(0,s.setReferenceManifestsSingleton)({page:_,clientReferenceManifest:T,serverActionsManifest:I,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:I})});let D=e.method||"GET",F=(0,i.getTracer)(),$=F.getActiveScopeSpan(),z={params:b,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>E.onRequestError(e,t,a,k)},sharedContext:{buildId:R}},J=new c.NodeNextRequest(e),W=new c.NodeNextResponse(t),G=d.NextRequestAdapter.fromNodeNextRequest(J,(0,d.signalFromNodeResponse)(t));try{let s=async e=>E.handle(G,z).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${D} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${D} ${_}`)}),o=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var i,l;let c=async({previousCacheEntry:r})=>{try{if(!o&&S&&j&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(n);e.fetchMetrics=z.renderOpts.fetchMetrics;let l=z.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=z.renderOpts.collectedTags;if(!q)return await (0,g.sendResponse)(J,W,i,z.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==z.renderOpts.collectedRevalidate&&!(z.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&z.renderOpts.collectedRevalidate,a=void 0===z.renderOpts.collectedExpire||z.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:z.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await E.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:B,isOnDemandRevalidate:S})},k),t}},d=await E.handleResponse({req:e,nextConfig:w,cacheKey:H,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:j,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:o});if(!q)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",S?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),O&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,m.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&q||u.delete(f.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,h.getCacheControlHeader)(d.cacheControl)),await (0,g.sendResponse)(J,W,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};$?await l($):await F.withPropagatedContext(e.headers,()=>F.trace(u.BaseServerSpan.handleRequest,{spanName:`${D} ${_}`,kind:i.SpanKind.SERVER,attributes:{"http.method":D,"http.target":e.url}},l))}catch(t){if(t instanceof y.NoFallbackError||await E.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:B,isOnDemandRevalidate:S})}),q)throw t;return await (0,g.sendResponse)(J,W,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>k,"routeModule",()=>E,"serverHooks",()=>N,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>O],682282)},216653,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__a6a8820c._.js"].map(t=>e.l(t))).then(()=>t(439609)))},792892,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__8bbeb9a7._.js"].map(t=>e.l(t))).then(()=>t(927791)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__f0891cfe._.js.map