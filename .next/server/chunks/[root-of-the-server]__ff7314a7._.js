module.exports=[918622,(e,t,s)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,s)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,s)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,s)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,s)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},779314,e=>{"use strict";var t=e.i(252736);function s(){return(0,t.createClient)("https://xqyecqkrtaydoesxnvlw.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}e.s(["createAdminClient",()=>s])},872131,e=>{"use strict";var t=e.i(248749),s=e.i(219650),r=e.i(508677),a=e.i(615159),n=e.i(548938),o=e.i(273073),i=e.i(129714),d=e.i(403736),l=e.i(817889),p=e.i(428765),u=e.i(762198),c=e.i(117109),h=e.i(590702),f=e.i(462216),g=e.i(539401),m=e.i(222695),x=e.i(193695);e.i(31514);var R=e.i(267074),v=e.i(779314),w=e.i(490788);async function E(){let e={steps:[],success:!1};try{let t=(0,v.createAdminClient)();try{e.steps.push({step:1,name:"Check table access",status:"running"});let{count:s,error:r}=await t.from("scraped_tenders").select("*",{count:"exact",head:!0});if(r)return e.steps[0].status="failed",e.steps[0].error=r.message,w.NextResponse.json(e,{status:200});e.steps[0].status="passed",e.steps[0].currentCount=s}catch(t){return e.steps[0].status="failed",e.steps[0].error=t instanceof Error?t.message:String(t),w.NextResponse.json(e,{status:200})}try{e.steps.push({step:2,name:"Get existing source",status:"running"});let{data:s,error:r}=await t.from("tender_sources").select("id, name").limit(1).single();if(r||!s)return e.steps[1].status="failed",e.steps[1].error=r?.message||"No tender sources found in database. Please add at least one tender source.",w.NextResponse.json(e,{status:200});e.steps[1].status="passed",e.steps[1].sourceId=s.id,e.steps[1].sourceName=s.name;try{e.steps.push({step:3,name:"Clean up old test tenders",status:"running"}),await t.from("scraped_tenders").delete().like("tender_reference","TEST-%"),e.steps[2].status="passed",e.steps[2].message="Cleaned up old test tenders"}catch(t){console.log("[v0] Warning: Could not delete old test tenders:",t),e.steps[2].status="passed",e.steps[2].message="Cleanup skipped"}try{e.steps.push({step:4,name:"Insert test tender",status:"running"});let r={source_id:s.id,tender_reference:`TEST-${Date.now()}-${Math.random().toString(36).substring(7)}`,title:"TEST: Website Development Services",description:"This is a test tender to verify the scraping and display pipeline is working correctly.",source_name:"Test Municipality",source_level:"municipal",source_province:"Gauteng",close_date:new Date(Date.now()+2592e6).toISOString(),source_url:"https://test.example.com/tender",tender_url:"https://test.example.com/tender",category:"IT Services",estimated_value:"R 500,000",is_active:!0,scraped_at:new Date().toISOString()},{data:a,error:n}=await t.from("scraped_tenders").insert(r).select().single();if(n)return e.steps[3].status="failed",e.steps[3].error=n.message,e.steps[3].errorCode=n.code,w.NextResponse.json(e,{status:200});e.steps[3].status="passed",e.steps[3].tenderId=a.id;try{e.steps.push({step:5,name:"Read tender back",status:"running"});let{data:s,error:r}=await t.from("scraped_tenders").select("*").eq("id",a.id).single();if(r)return e.steps[4].status="failed",e.steps[4].error=r.message,w.NextResponse.json(e,{status:200});e.steps[4].status="passed",e.steps[4].tenderTitle=s.title}catch(t){return e.steps[4].status="failed",e.steps[4].error=t instanceof Error?t.message:String(t),w.NextResponse.json(e,{status:200})}try{e.steps.push({step:6,name:"Test database search",status:"running"});let{data:s,count:r}=await t.from("scraped_tenders").select("*",{count:"exact"}).ilike("title","%TEST%").limit(10),n=s?.find(e=>e.id===a.id);e.steps[5].status=n?"passed":"failed",e.steps[5].totalResults=r,e.steps[5].foundTestTender=!!n}catch(t){return e.steps[5].status="failed",e.steps[5].error=t instanceof Error?t.message:String(t),w.NextResponse.json(e,{status:200})}try{e.steps.push({step:7,name:"Count all tenders",status:"running"});let{count:s}=await t.from("scraped_tenders").select("*",{count:"exact",head:!0});e.steps[6].status="passed",e.steps[6].totalTenders=s}catch(t){return e.steps[6].status="failed",e.steps[6].error=t instanceof Error?t.message:String(t),w.NextResponse.json(e,{status:200})}}catch(t){return e.steps[3]=e.steps[3]||{step:4,name:"Insert test tender",status:"failed"},e.steps[3].error=t instanceof Error?t.message:String(t),w.NextResponse.json(e,{status:200})}}catch(t){return e.steps[1]=e.steps[1]||{step:2,name:"Get existing source",status:"failed"},e.steps[1].error=t instanceof Error?t.message:String(t),w.NextResponse.json(e,{status:200})}return e.success=e.steps.every(e=>"passed"===e.status),e.message=e.success?"✅ All tests passed! The tender pipeline is working correctly.":"❌ Some tests failed. Check the steps above for details.",w.NextResponse.json(e)}catch(t){return e.error=t instanceof Error?t.message:String(t),e.stack=t instanceof Error?t.stack:void 0,w.NextResponse.json(e,{status:200})}}e.s(["POST",()=>E],210581);var y=e.i(210581);let C=new t.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/test-tender-flow/route",pathname:"/api/test-tender-flow",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/test-tender-flow/route.ts",nextConfigOutput:"",userland:y}),{workAsyncStorage:S,workUnitAsyncStorage:T,serverHooks:_}=C;function N(){return(0,r.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:T})}async function b(e,t,r){C.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/test-tender-flow/route";v=v.replace(/\/index$/,"")||"/";let w=await C.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:E,params:y,nextConfig:S,parsedUrl:T,isDraftMode:_,prerenderManifest:N,routerServerContext:b,isOnDemandRevalidate:A,revalidateOnlyGenerated:k,resolvedPathname:j,clientReferenceManifest:P,serverActionsManifest:O}=w,I=(0,d.normalizeAppPath)(v),q=!!(N.dynamicRoutes[I]||N.routes[j]),D=async()=>((null==b?void 0:b.render404)?await b.render404(e,t,T,!1):t.end("This page could not be found"),null);if(q&&!_){let e=!!N.routes[j],t=N.dynamicRoutes[I];if(t&&!1===t.fallback&&!e){if(S.experimental.adapterPath)return await D();throw new x.NoFallbackError}}let M=null;!q||C.isDev||_||(M="/index"===(M=j)?"/":M);let H=!0===C.isDev||!q,U=q&&!H;O&&P&&(0,o.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:P,serverActionsManifest:O,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:O})});let $=e.method||"GET",K=(0,n.getTracer)(),F=K.getActiveScopeSpan(),B={params:y,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!S.experimental.authInterrupts},cacheComponents:!!S.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:S.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,s,r)=>C.onRequestError(e,t,r,b)},sharedContext:{buildId:E}},G=new l.NodeNextRequest(e),L=new l.NodeNextResponse(t),V=p.NextRequestAdapter.fromNodeNextRequest(G,(0,p.signalFromNodeResponse)(t));try{let o=async e=>C.handle(V,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let s=K.getRootSpanAttributes();if(!s)return;if(s.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${s.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=s.get("next.route");if(r){let t=`${$} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${$} ${v}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),d=async a=>{var n,d;let l=async({previousCacheEntry:s})=>{try{if(!i&&A&&k&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(a);e.fetchMetrics=B.renderOpts.fetchMetrics;let d=B.renderOpts.pendingWaitUntil;d&&r.waitUntil&&(r.waitUntil(d),d=void 0);let l=B.renderOpts.collectedTags;if(!q)return await (0,h.sendResponse)(G,L,n,B.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(n.headers);l&&(t[m.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let s=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,r=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:R.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:s,expire:r}}}}catch(t){throw(null==s?void 0:s.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:A})},b),t}},p=await C.handleResponse({req:e,nextConfig:S,cacheKey:M,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:k,responseGenerator:l,waitUntil:r.waitUntil,isMinimalMode:i});if(!q)return null;if((null==p||null==(n=p.value)?void 0:n.kind)!==R.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(d=p.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",A?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,f.fromNodeOutgoingHttpHeaders)(p.value.headers);return i&&q||u.delete(m.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,g.getCacheControlHeader)(p.cacheControl)),await (0,h.sendResponse)(G,L,new Response(p.value.body,{headers:u,status:p.value.status||200})),null};F?await d(F):await K.withPropagatedContext(e.headers,()=>K.trace(u.BaseServerSpan.handleRequest,{spanName:`${$} ${v}`,kind:n.SpanKind.SERVER,attributes:{"http.method":$,"http.target":e.url}},d))}catch(t){if(t instanceof x.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:A})}),q)throw t;return await (0,h.sendResponse)(G,L,new Response(null,{status:500})),null}}e.s(["handler",()=>b,"patchFetch",()=>N,"routeModule",()=>C,"serverHooks",()=>_,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>T],872131)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ff7314a7._.js.map