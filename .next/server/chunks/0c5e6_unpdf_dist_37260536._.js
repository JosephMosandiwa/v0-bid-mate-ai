module.exports=[278893,t=>{"use strict";let a,e,n=globalThis.process?.release?.name==="node";async function r(t,a={}){let{getDocument:e}=await i();return await e({data:t,isEvalSupported:!1,useSystemFonts:!0,...a}).promise}async function i(){return a||await s(),a}async function s(e,{reload:n=!1}={}){if(!a||n){if(e)try{a=await c(e());return}catch(t){throw Error(`PDF.js could not be resolved: ${t}`)}try{a=await t.A(299739)}catch(t){throw Error(`Serverless PDF.js bundle could not be resolved: ${t}`)}}}function o(t){return"object"==typeof t&&null!==t&&"_pdfInfo"in t}async function c(t){let a=await t;return a.default||a}class l{#t=!1;constructor({enableHWA:t=!1}={}){this.#t=t}create(t,a){let e=this._createCanvas(t,a);return{canvas:e,context:e.getContext("2d",{willReadFrequently:!this.#t})}}reset({canvas:t},a,e){if(!t)throw Error("Canvas is not specified");t.width=a,t.height=e}destroy(t){if(!t.canvas)throw Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=void 0,t.context=void 0}_createCanvas(t,a){throw Error("Not implemented")}}class u extends l{constructor({enableHWA:t=!1}={}){super({enableHWA:t})}_createCanvas(t,a){if(!e)throw Error("@napi-rs/canvas module is not resolved");return e.createCanvas(t,a)}}async function d(t){e??=await c(t())}async function w(t,a){let e=o(t)?t:await r(t);if(a<1||a>e.numPages)throw Error(`Invalid page number. Must be between 1 and ${e.numPages}.`);let n=await e.getPage(a),s=await n.getOperatorList(),{OPS:c}=await i(),l=[];for(let t=0;t<s.fnArray.length;t++){if(s.fnArray[t]!==c.paintImageXObject)continue;let a=s.argsArray[t][0],e=await new Promise(t=>(a.startsWith("g_")?n.commonObjs:n.objs).get(a,t));if(!e||!e.data||!e.width||!e.height)continue;let{width:r,height:i,data:o}=e,u=o.length/(r*i);[1,3,4].includes(u)&&l.push({data:o,width:r,height:i,channels:u,key:a})}return l}async function g(t,a,e={}){let n=await h(e.canvasImport),i=o(t)?t:await r(t,{CanvasFactory:n}),s=await i.getPage(a);if(a<1||a>i.numPages)throw Error(`Invalid page number. Must be between 1 and ${i.numPages}.`);let c=s.getViewport({scale:1}),l=e.scale||1;e.width?l=e.width/c.width:e.height&&(l=e.height/c.height);let u=s.getViewport({scale:Math.max(0,l)}),d=new n().create(u.width,u.height);await s.render({canvas:d.canvas,canvasContext:d.context,viewport:u}).promise;let w=d.canvas.toDataURL();if(e.toDataURL)return w;let f=await fetch(w);return await f.arrayBuffer()}async function h(t){if(n){if(!t)throw Error('Parameter "canvasImport" is required in Node.js environment.');return await d(t),e&&(void 0===globalThis.DOMMatrix&&(globalThis.DOMMatrix=e.DOMMatrix),void 0===globalThis.ImageData&&(globalThis.ImageData=e.ImageData),void 0===globalThis.Path2D&&(globalThis.Path2D=e.Path2D)),u}throw Error("Unsupported environment for canvas creation.")}async function f(t){let a=o(t)?t:await r(t),e=await Promise.all(Array.from({length:a.numPages},(t,e)=>m(a,e+1)));return{totalPages:a.numPages,links:e.flat()}}async function m(t,a){let e=await t.getPage(a),n=await e.getAnnotations(),r=[];for(let t of n)"Link"===t.subtype&&t.url&&r.push(t.url);return r}let p=["xmp:createdate","xmp:modifydate","xmp:metadatadate","xap:createdate","xap:modifydate","xap:metadatadate"];async function y(t,a={}){let e=o(t)?t:await r(t),n=await e.getMetadata(),s=n?.info||{};if(a.parseDates){let{PDFDateString:t}=await i();s?.CreationDate&&(s.CreationDate=t.toDateObject(s?.CreationDate)),s?.ModDate&&(s.ModDate=t.toDateObject(s?.ModDate)),n.metadata&&(n.metadata=new Proxy(n.metadata,{get:(t,a)=>"get"===a?a=>{let e=t.get(a);return p.includes(a)&&e?function(t){if(!t)return;let a=Date.parse(t);if(!Number.isNaN(a))return new Date(a)}(e):e}:t[a]}))}return{info:s,metadata:n?.metadata||{}}}async function v(t,a={}){let{mergePages:e=!1}=a,n=o(t)?t:await r(t),i=await Promise.all(Array.from({length:n.numPages},(t,a)=>P(n,a+1)));return{totalPages:n.numPages,text:e?i.join("\n").replace(/\s+/g," "):i}}async function P(t,a){let e=await t.getPage(a);return(await e.getTextContent()).items.filter(t=>null!=t.str).map(t=>t.str+(t.hasEOL?"\n":"")).join("")}async function D(t){await s(t,{reload:!0})}async function b(t){await s(t.pdfjs,{reload:!0})}let x=async(...t)=>(await s(),await y(...t)),j=async(...t)=>(await s(),await v(...t)),M=async(...t)=>(await s(),await w(...t)),C=async(...t)=>(await s(),await g(...t)),I=async(...t)=>(await s(),await f(...t));t.s(["configureUnPDF",()=>b,"createIsomorphicCanvasFactory",()=>h,"definePDFJSModule",()=>D,"extractImages",()=>M,"extractLinks",()=>I,"extractText",()=>j,"getDocumentProxy",()=>r,"getMeta",()=>x,"getResolvedPDFJS",()=>i,"renderPageAsImage",()=>C,"resolvePDFJSImport",()=>s])},299739,t=>{t.v(a=>Promise.all(["server/chunks/0c5e6_unpdf_dist_pdfjs_mjs_4dc36419._.js"].map(a=>t.l(a))).then(()=>a(51769)))}];

//# sourceMappingURL=0c5e6_unpdf_dist_37260536._.js.map