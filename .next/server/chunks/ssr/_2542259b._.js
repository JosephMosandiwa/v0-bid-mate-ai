module.exports=[86765,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(924044)},591667,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},998310,a=>{"use strict";a.i(83615);var b=a.i(157962),c=a.i(58297);async function d(){let a=await (0,c.cookies)();return(0,b.createServerClient)("https://xqyecqkrtaydoesxnvlw.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhxeWVjcWtydGF5ZG9lc3hudmx3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzMjM0NTgsImV4cCI6MjA3Njg5OTQ1OH0.wsb5Jz_I9RqxoNoZ6D3QPbK4aefbdGKcrGgWDfm3c4o",{cookies:{getAll:()=>a.getAll(),setAll(b){try{b.forEach(({name:b,value:c,options:d})=>a.set(b,c,d))}catch{}}}})}a.s(["createClient",()=>d,"createServerClient",0,d])},283445,a=>{"use strict";var b=a.i(86765),c=a.i(998310),d=a.i(206647);async function e(a){let b=await (0,c.createClient)(),{data:{user:e}}=await b.auth.getUser();if(!e)return{success:!1,error:"Not authenticated"};let f=a.get("file"),g=a.get("userTenderId");if(!f||!g)return{success:!1,error:"File and tender ID are required"};let h=f.name.split(".").pop(),i=`${e.id}/${g}/${Date.now()}.${h}`,{data:j,error:k}=await b.storage.from("tender-documents").upload(i,f);if(k)return console.error("[v0] Error uploading file:",k),{success:!1,error:"Failed to upload file"};let{data:l,error:m}=await b.from("tender_documents").insert({user_tender_id:g,user_id:e.id,file_name:f.name,file_size:f.size,file_type:f.type,storage_path:j.path}).select().single();return m?(console.error("[v0] Error saving document metadata:",m),await b.storage.from("tender-documents").remove([i]),{success:!1,error:"Failed to save document"}):((0,d.revalidatePath)(`/dashboard/tenders/${g}`),{success:!0,data:l})}async function f(a){let b=await (0,c.createClient)(),{data:{user:d}}=await b.auth.getUser();if(!d)return{success:!1,error:"Not authenticated",documents:[]};let{data:e,error:f}=await b.from("tender_documents").select("*").eq("user_tender_id",a).eq("user_id",d.id).order("created_at",{ascending:!1});return f?(console.error("[v0] Error fetching documents:",f),{success:!1,error:"Failed to fetch documents",documents:[]}):{success:!0,documents:e||[]}}async function g(a){let b=await (0,c.createClient)(),{data:{user:d}}=await b.auth.getUser();if(!d)return{success:!1,error:"Not authenticated"};let{data:e,error:f}=await b.from("tender_documents").select("*").eq("id",a).eq("user_id",d.id).single();if(f||!e)return console.error("[v0] Error fetching document:",f),{success:!1,error:"Document not found"};if(e.storage_path.startsWith("http://")||e.storage_path.startsWith("https://"))return console.log("[v0] Returning external document URL:",e.storage_path),{success:!0,url:e.storage_path,fileName:e.file_name};let{data:g,error:h}=await b.storage.from("tender-documents").createSignedUrl(e.storage_path,60);return h?(console.error("[v0] Error creating signed URL:",h),{success:!1,error:"Failed to generate download link"}):{success:!0,url:g.signedUrl,fileName:e.file_name}}async function h(a){let b=await (0,c.createClient)(),{data:{user:e}}=await b.auth.getUser();if(!e)return{success:!1,error:"Not authenticated"};let{data:f,error:g}=await b.from("tender_documents").select("*").eq("id",a).eq("user_id",e.id).single();if(g||!f)return{success:!1,error:"Document not found"};let{error:h}=await b.storage.from("tender-documents").remove([f.storage_path]);h&&console.error("[v0] Error deleting from storage:",h);let{error:i}=await b.from("tender_documents").delete().eq("id",a).eq("user_id",e.id);return i?(console.error("[v0] Error deleting document:",i),{success:!1,error:"Failed to delete document"}):((0,d.revalidatePath)(`/dashboard/tenders/${f.user_tender_id}`),{success:!0})}async function i(a,b){let e=await (0,c.createClient)(),{data:{user:f}}=await e.auth.getUser();if(!f)return{success:!1,error:"Not authenticated"};try{console.log("[v0] Saving analysis for document:",a);let{error:c}=await e.from("tender_documents").update({ai_analysis:b}).eq("id",a).eq("user_id",f.id);if(c)return console.error("[v0] Error saving analysis:",c),{success:!1,error:"Failed to save analysis"};return console.log("[v0] Analysis saved successfully"),(0,d.revalidatePath)("/dashboard/tenders"),{success:!0,analysis:b}}catch(a){return console.error("[v0] Error in analyzeDocument:",a),{success:!1,error:"Failed to save analysis"}}}async function j(a){let b=await (0,c.createClient)(),{data:{user:d}}=await b.auth.getUser();if(!d)return{success:!1,error:"Not authenticated"};let e=a.get("file");if(!e)return{success:!1,error:"File is required"};let f=e.name.split(".").pop(),g=`temp/${d.id}/${Date.now()}.${f}`,{data:h,error:i}=await b.storage.from("tender-documents").upload(g,e);if(i)return console.error("[v0] Error uploading file:",i),{success:!1,error:"Failed to upload file"};let{data:j,error:k}=await b.storage.from("tender-documents").createSignedUrl(g,3600);return k?(console.error("[v0] Error getting signed URL:",k),{success:!1,error:"Failed to get file URL"}):{success:!0,url:j.signedUrl,path:g}}(0,a.i(591667).ensureServerEntryExports)([e,f,g,h,i,j]),(0,b.registerServerReference)(e,"407506f17c78cd82f3f1653fad7e6e3de94bde6559",null),(0,b.registerServerReference)(f,"403d0f372611b65a15156fa766b013a0094147439b",null),(0,b.registerServerReference)(g,"407830ff44362a5479a4026764a941fed808c7a874",null),(0,b.registerServerReference)(h,"408b03003ef40ae89abebb6faa0759ca38ad5f262d",null),(0,b.registerServerReference)(i,"600d7588a4562c5d0fb266ce9e61ca54c8b6b3ffbd",null),(0,b.registerServerReference)(j,"4040f46a12af21bd15bb0204eb6028b06455093439",null),a.s(["analyzeDocument",()=>i,"deleteTenderDocument",()=>h,"downloadTenderDocument",()=>g,"uploadTemporaryDocument",()=>j,"uploadTenderDocument",()=>e])},79816,a=>{"use strict";var b=a.i(283445),c=a.i(651547);a.s([],520183),a.i(520183),a.s(["407506f17c78cd82f3f1653fad7e6e3de94bde6559",()=>b.uploadTenderDocument,"407830ff44362a5479a4026764a941fed808c7a874",()=>b.downloadTenderDocument,"407a8ca08fcf9739cce046a54db0f5cf64d000762a",()=>c.saveScrapedTenderToUser,"408b03003ef40ae89abebb6faa0759ca38ad5f262d",()=>b.deleteTenderDocument,"600d7588a4562c5d0fb266ce9e61ca54c8b6b3ffbd",()=>b.analyzeDocument],79816)}];

//# sourceMappingURL=_2542259b._.js.map