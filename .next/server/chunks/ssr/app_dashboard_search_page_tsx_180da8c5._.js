module.exports=[706939,a=>{"use strict";var b=a.i(526689),c=a.i(248472),d=a.i(197665),e=a.i(125712),f=a.i(703130),g=a.i(340695),h=a.i(205522),i=a.i(254161),j=a.i(674864),k=a.i(926437),l=a.i(256142),m=a.i(435483),n=a.i(738611),o=a.i(600082),p=a.i(861084),q=a.i(83566),r=a.i(100715),s=a.i(546893),t=a.i(887682),u=a.i(112160),v=(0,u.createServerReference)("406ac9a12410c4d1e5c3a20b285241fb05f70730dc",u.callServer,void 0,u.findSourceMapURL,"addTenderToUser"),w=a.i(277687);function x(){let[a,u]=(0,e.useState)(""),[x,y]=(0,e.useState)(""),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)([]),[D,E]=(0,e.useState)(""),[F,G]=(0,e.useState)(""),[H,I]=(0,e.useState)("basic"),[J,K]=(0,e.useState)("all"),[L,M]=(0,e.useState)("all"),[N,O]=(0,e.useState)(""),[P,Q]=(0,e.useState)(""),{toast:R}=(0,w.useToast)(),[S,T]=(0,e.useState)(null);(0,e.useEffect)(()=>{U()},[]),(0,e.useEffect)(()=>{"basic"===H&&V()},[J,L,N,P]);let U=async()=>{A(!0),G("");try{let a=new URLSearchParams({q:"",limit:"50"});console.log("[v0] Loading all tenders");let b=await fetch(`/api/tenders/search?${a.toString()}`);if(console.log("[v0] Load all tenders response status:",b.status),!b.ok){let a=await b.json();throw console.error("[v0] Load all tenders error response:",a),Error(a.details||"Failed to load tenders")}let c=await b.json();console.log("[v0] Load all tenders results:",c),0===c.total&&G("No tenders available yet. The database may need to be populated with scraped tenders."),C(c.tenders||[])}catch(a){G(a instanceof Error?a.message:"Failed to load tenders. Please try again."),console.error("[v0] Load all tenders error:",a)}finally{A(!1)}},V=async b=>{b&&b.preventDefault(),A(!0),G(""),C([]);try{let b=new URLSearchParams({q:a,limit:"50"});"all"!==J&&b.append("level",J),"all"!==L&&b.append("province",L),N&&b.append("dateFrom",N),P&&b.append("dateTo",P),console.log("[v0] Searching with params:",b.toString());let c=await fetch(`/api/tenders/search?${b.toString()}`);if(console.log("[v0] Search response status:",c.status),!c.ok){let a=await c.json();throw console.error("[v0] Search error response:",a),Error(a.details||"Failed to search tenders")}let d=await c.json();console.log("[v0] Search results:",d),0!==d.total||a||"all"!==J||"all"!==L||N||P||G("No tenders available yet. The database may need to be populated with scraped tenders."),C(d.tenders||[])}catch(a){G(a instanceof Error?a.message:"Failed to search tenders. Please try again."),console.error("[v0] Search error:",a)}finally{A(!1)}},W=async()=>{if(x.trim()){A(!0),G(""),E(""),C([]);try{let a=await fetch("/api/ai-tender-search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:x})});if(!a.ok)throw Error("Failed to search tenders");let b=await a.json();E(b.response||""),C(b.tenders||[])}catch(a){G("Failed to search tenders. Please try again."),console.error("[v0] AI search error:",a)}finally{A(!1)}}},X=async a=>{T(a.id);let b=a.organization||a.source_name||"Unknown Organization",c=a.publishDate||a.publish_date||new Date().toISOString().split("T")[0],d=a.closeDate||a.close_date||c,e=a.value||a.estimated_value,f=a.url||a.tender_url;try{let g=await v({tenderId:a.id,title:a.title,organization:b,publishDate:c,closeDate:d,value:e,category:a.category,description:a.description,url:f,documents:a.documents});g.success?R({title:"Tender added",description:`${a.title} has been added to your tenders`}):R({title:"Error",description:g.error||"Failed to add tender",variant:"destructive"})}catch(a){console.error("[v0] Error adding tender:",a),R({title:"Error",description:"Failed to add tender",variant:"destructive"})}finally{T(null)}},Y=async()=>{console.log("[v0] Testing search API directly...");try{let a=await fetch("/api/tenders/search?q=&limit=50");console.log("[v0] Response status:",a.status);let b=await a.json();console.log("[v0] Response data:",b),console.log("[v0] Number of tenders:",b.tenders?.length||0),console.log("[v0] Total from API:",b.total),b.tenders&&b.tenders.length>0&&(C(b.tenders),console.log("[v0] State updated with tenders"))}catch(a){console.error("[v0] API test error:",a)}};return(0,b.jsx)("div",{className:"min-h-screen bg-background",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-4 md:py-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Search Tenders"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[B.length>0&&(0,b.jsxs)(i.Badge,{variant:"secondary",className:"text-sm",children:[B.length," loaded"]}),(0,b.jsx)(g.Button,{onClick:Y,variant:"outline",size:"sm",children:"Test Search API (Check Console)"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(g.Button,{variant:"basic"===H?"default":"outline",onClick:()=>I("basic"),className:"basic"!==H?"bg-transparent":"",size:"sm",children:[(0,b.jsx)(j.Search,{className:"h-4 w-4 mr-2"}),"Basic Search"]}),(0,b.jsxs)(g.Button,{variant:"ai"===H?"default":"outline",onClick:()=>I("ai"),className:"ai"!==H?"bg-transparent":"",size:"sm",children:[(0,b.jsx)(k.Sparkles,{className:"h-4 w-4 mr-2"}),"AI Assistant"]})]}),(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(g.Button,{onClick:Y,variant:"outline",size:"sm",children:"Test Search API (Check Console)"})}),"basic"===H?(0,b.jsxs)(f.Card,{className:"border-border",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{className:"text-lg md:text-xl",children:"Basic Search"}),(0,b.jsx)(f.CardDescription,{className:"text-sm",children:"Search for tenders by keywords, category, or organization"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("form",{onSubmit:V,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsx)(h.Input,{placeholder:"e.g., medical supplies, IT services...",value:a,onChange:a=>u(a.target.value),className:"flex-1"}),(0,b.jsx)(g.Button,{type:"submit",disabled:z,className:"w-full sm:w-auto",children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Searching..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Search,{className:"h-4 w-4 mr-2"}),"Search"]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-4",children:[(0,b.jsxs)(t.Select,{value:J,onValueChange:K,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-full",children:(0,b.jsx)(t.SelectValue,{placeholder:"Filter by level"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All Levels"}),(0,b.jsx)(t.SelectItem,{value:"National",children:"National"}),(0,b.jsx)(t.SelectItem,{value:"Provincial",children:"Provincial"}),(0,b.jsx)(t.SelectItem,{value:"Metro",children:"Metro"}),(0,b.jsx)(t.SelectItem,{value:"SOE",children:"SOE"}),(0,b.jsx)(t.SelectItem,{value:"Public Entity",children:"Public Entity"})]})]}),(0,b.jsxs)(t.Select,{value:L,onValueChange:M,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-full",children:(0,b.jsx)(t.SelectValue,{placeholder:"Filter by province"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All Provinces"}),(0,b.jsx)(t.SelectItem,{value:"Gauteng",children:"Gauteng"}),(0,b.jsx)(t.SelectItem,{value:"Western Cape",children:"Western Cape"}),(0,b.jsx)(t.SelectItem,{value:"KwaZulu-Natal",children:"KwaZulu-Natal"}),(0,b.jsx)(t.SelectItem,{value:"Eastern Cape",children:"Eastern Cape"}),(0,b.jsx)(t.SelectItem,{value:"Free State",children:"Free State"}),(0,b.jsx)(t.SelectItem,{value:"Limpopo",children:"Limpopo"}),(0,b.jsx)(t.SelectItem,{value:"Mpumalanga",children:"Mpumalanga"}),(0,b.jsx)(t.SelectItem,{value:"Northern Cape",children:"Northern Cape"}),(0,b.jsx)(t.SelectItem,{value:"North West",children:"North West"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("label",{htmlFor:"dateFrom",className:"text-xs text-muted-foreground",children:"Closing From"}),(0,b.jsx)(h.Input,{id:"dateFrom",type:"date",value:N,onChange:a=>O(a.target.value),className:"w-full"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("label",{htmlFor:"dateTo",className:"text-xs text-muted-foreground",children:"Closing To"}),(0,b.jsx)(h.Input,{id:"dateTo",type:"date",value:P,onChange:a=>Q(a.target.value),className:"w-full"})]})]}),("all"!==J||"all"!==L||N||P)&&(0,b.jsx)(g.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{K("all"),M("all"),O(""),Q("")},className:"w-full sm:w-auto",children:"Clear Filters"}),F&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:F})]})})]}):(0,b.jsxs)(f.Card,{className:"border-border bg-primary/5",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Sparkles,{className:"h-5 w-5 text-primary"}),(0,b.jsx)(f.CardTitle,{children:"BidMate AI Assistant"})]}),(0,b.jsx)(f.CardDescription,{children:"Describe what you're looking for in natural language and let AI find relevant tenders"})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,b.jsx)(s.Textarea,{placeholder:"e.g., I'm looking for construction tenders in Gauteng province worth more than R5 million that close in the next 30 days...",value:x,onChange:a=>y(a.target.value),rows:4}),(0,b.jsx)(g.Button,{onClick:W,disabled:z||!x.trim(),className:"w-full",children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Searching..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Sparkles,{className:"h-4 w-4 mr-2"}),"Search with AI"]})}),F&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:F}),D&&(0,b.jsxs)("div",{className:"mt-4 p-4 rounded-lg bg-background border border-border",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2 mb-2",children:[(0,b.jsx)(q.MessageSquare,{className:"h-4 w-4 text-primary mt-1"}),(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:"AI Response"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:D})]})]})]}),B.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)("h2",{className:"text-lg md:text-xl font-semibold text-foreground",children:a||"all"!==J||"all"!==L||N||P?`Found ${B.length} ${1===B.length?"Tender":"Tenders"}`:`All Tenders (${B.length})`})}),(0,b.jsx)("div",{className:"grid gap-4",children:B.map(a=>{let e=a.organization||a.source_name||"Unknown Organization",h=a.closeDate||a.close_date,j=a.value||a.estimated_value,k=a.url||a.tender_url,q=a.tender_type,s=a.location||a.source_province;return(0,b.jsx)(f.Card,{className:"border-border hover:border-primary transition-colors",children:(0,b.jsx)(f.CardHeader,{className:"p-4 md:p-6",children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"flex items-start gap-2 mb-2 flex-wrap",children:(0,b.jsx)(c.default,{href:`/dashboard/scraped-tenders/${a.id}`,className:"flex-1 min-w-0",children:(0,b.jsx)(f.CardTitle,{className:"text-base md:text-lg hover:text-primary transition-colors cursor-pointer break-words",children:a.title})})}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[(0,b.jsx)(i.Badge,{className:"bg-primary/10 text-primary text-xs",children:a.category||"General"}),q&&(0,b.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:q}),a.source_level&&(0,b.jsx)(i.Badge,{variant:"outline",className:"text-xs",children:a.source_level}),s&&(0,b.jsx)(i.Badge,{variant:"secondary",className:"text-xs",children:s})]}),(0,b.jsxs)(f.CardDescription,{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 flex-wrap text-xs md:text-sm",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.Building2,{className:"h-4 w-4 flex-shrink-0"}),(0,b.jsx)("span",{className:"truncate",children:e})]}),h&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Calendar,{className:"h-4 w-4 flex-shrink-0"}),"Closes: ",new Date(h).toLocaleDateString()]}),j&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(n.DollarSign,{className:"h-4 w-4 flex-shrink-0"}),j]})]}),(0,b.jsx)("p",{className:"text-xs md:text-sm line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.FileText,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsxs)("span",{className:"text-xs md:text-sm text-muted-foreground",children:[a.document_count??a.document_urls?.length??0," ",(a.document_count??a.document_urls?.length??0)===1?"document":"documents"]})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsx)(g.Button,{size:"sm",variant:"outline",asChild:!0,className:"bg-transparent w-full sm:w-auto",children:(0,b.jsxs)(c.default,{href:`/dashboard/scraped-tenders/${a.id}`,children:[(0,b.jsx)(d.FileText,{className:"h-4 w-4 mr-2"}),"View Details"]})}),k&&(0,b.jsx)(g.Button,{variant:"outline",size:"sm",asChild:!0,className:"bg-transparent w-full sm:w-auto",children:(0,b.jsxs)("a",{href:k,target:"_blank",rel:"noopener noreferrer",children:[(0,b.jsx)(o.ExternalLink,{className:"h-4 w-4 mr-2"}),"Original Listing"]})}),(0,b.jsx)(g.Button,{size:"sm",onClick:()=>X(a),disabled:S===a.id,className:"w-full sm:w-auto",children:S===a.id?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Plus,{className:"h-4 w-4 mr-2"}),"Add to My Tenders"]})})]})]})})},a.id)})})]}),!z&&0===B.length&&(0,b.jsx)(f.Card,{className:"border-border",children:(0,b.jsxs)(f.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(j.Search,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg md:text-xl font-semibold text-foreground mb-2",children:"No Tenders Found"}),(0,b.jsx)("p",{className:"text-sm md:text-base text-muted-foreground",children:a||"all"!==J||"all"!==L||N||P?"Try adjusting your search terms or filters":"No tenders available yet. Please run the scraper to populate the database."})]})})]})]})})}a.s(["default",()=>x],706939)}];

//# sourceMappingURL=app_dashboard_search_page_tsx_180da8c5._.js.map