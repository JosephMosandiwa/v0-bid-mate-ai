module.exports=[25613,a=>{"use strict";var b=a.i(526689),c=a.i(125712),d=a.i(294411),e=a.i(703130),f=a.i(340695),g=a.i(205522),h=a.i(917171),i=a.i(231807),j=a.i(323746),k=a.i(197665),l=a.i(674375),m=a.i(861084),n=a.i(248472),o=a.i(265602),p=a.i(112160),q=(0,p.createServerReference)("404505f4575df6b361b5cc2add3d8bcc504a8c248d",p.callServer,void 0,p.findSourceMapURL,"createCustomTender"),r=(0,p.createServerReference)("4040f46a12af21bd15bb0204eb6028b06455093439",p.callServer,void 0,p.findSourceMapURL,"uploadTemporaryDocument"),s=a.i(277687),t=a.i(602150),u=a.i(254161),v=a.i(807518),w=a.i(738611),x=a.i(210299),y=a.i(621426),z=a.i(322409),A=a.i(167305),B=a.i(765393);let C={document:{name:"Document Analysis",icon:k.FileText,description:"Extracting text and form fields",phase:1},tender_analysis:{name:"Tender Requirements",icon:v.CheckCircle,description:"Analyzing requirements and criteria",phase:1},boq:{name:"BOQ Generation",icon:w.DollarSign,description:"Creating bill of quantities",phase:2},strategy:{name:"Strategy Development",icon:x.Target,description:"Generating bid strategy",phase:2},readiness:{name:"Readiness Assessment",icon:y.Shield,description:"Evaluating bid readiness",phase:2},risk:{name:"Risk Assessment",icon:z.AlertTriangle,description:"Identifying potential risks",phase:2},compliance:{name:"Compliance Check",icon:v.CheckCircle,description:"Validating compliance requirements",phase:2}};function D({orchestrationId:a,onComplete:d,pollInterval:f=2e3}){let[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!0);return((0,c.useEffect)(()=>{let b;if(!a||!k)return;let c=async()=>{try{let b=await fetch(`/api/orchestration/${a}/progress`);if(!b.ok)throw Error("Failed to fetch progress");let c=await b.json();h(c),j(null),("completed"===c.status||"failed"===c.status)&&(l(!1),d?.())}catch(a){console.error("Progress fetch error:",a),j(a.message)}};return c(),b=setInterval(c,f),()=>{b&&clearInterval(b)}},[a,k,f,d]),i)?(0,b.jsxs)(e.Card,{className:"border-destructive",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2 text-destructive",children:[(0,b.jsx)(B.XCircle,{className:"h-5 w-5"}),"Error Tracking Progress"]})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:i})})]}):g?(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{children:"AI Analysis Progress"}),(0,b.jsx)(e.CardDescription,{children:g.phase1Completed?"Phase 1 complete - Deep analysis in progress":"Analyzing tender document..."})]}),(a=>{switch(a){case"completed":return(0,b.jsx)(u.Badge,{className:"bg-green-600",children:"Complete"});case"processing":return(0,b.jsx)(u.Badge,{className:"bg-blue-600",children:"Processing..."});case"failed":return(0,b.jsx)(u.Badge,{variant:"destructive",children:"Failed"});case"partial_failure":return(0,b.jsx)(u.Badge,{className:"bg-orange-600",children:"Partial Success"});default:return(0,b.jsx)(u.Badge,{variant:"outline",children:"Unknown"})}})(g.status)]})}),(0,b.jsxs)(e.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Overall Progress"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[g.overallProgress,"%"]})]}),(0,b.jsx)(t.Progress,{value:g.overallProgress,className:"h-2"}),g.estimatedCompletion&&"processing"===g.status&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[(0,b.jsx)(A.Clock,{className:"h-3 w-3"}),"Estimated completion: ",new Date(g.estimatedCompletion).toLocaleTimeString()]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:["Phase 1: Critical Analysis",g.phase1Completed&&(0,b.jsx)(v.CheckCircle,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsx)("div",{className:"space-y-3",children:Object.entries(C).filter(([a,b])=>1===b.phase).map(([a,c])=>{let d=g.engines[a];return d?(0,b.jsx)(E,{name:c.name,description:c.description,icon:c.icon,progress:d},a):null})})]}),g.phase1Completed&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:["Phase 2: Deep Analysis",g.phase2Completed&&(0,b.jsx)(v.CheckCircle,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsx)("div",{className:"space-y-3",children:Object.entries(C).filter(([a,b])=>2===b.phase).map(([a,c])=>{let d=g.engines[a];return d?(0,b.jsx)(E,{name:c.name,description:c.description,icon:c.icon,progress:d},a):null})})]})]})]}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"py-8",children:(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,b.jsx)(m.Loader2,{className:"h-4 w-4 animate-spin"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading progress..."})]})})})}function E({name:a,description:c,icon:d,progress:e}){return(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"mt-0.5",children:(()=>{switch(e.status){case"completed":return(0,b.jsx)(v.CheckCircle,{className:"h-5 w-5 text-green-600"});case"processing":return(0,b.jsx)(m.Loader2,{className:"h-5 w-5 text-blue-600 animate-spin"});case"failed":return(0,b.jsx)(B.XCircle,{className:"h-5 w-5 text-destructive"});default:return(0,b.jsx)(A.Clock,{className:"h-5 w-5 text-muted-foreground"})}})()}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)(d,{className:"h-4 w-4 flex-shrink-0 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm font-medium truncate",children:a})]}),e.duration&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[e.duration.toFixed(1),"s"]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:c}),"processing"===e.status&&(0,b.jsx)(t.Progress,{value:e.progress,className:"h-1 mt-2"})]})]})}function F(){let a=(0,d.useRouter)(),{toast:p}=(0,s.useToast)(),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),G=async b=>{let c=b.target.files?.[0];if(c){if("application/pdf"!==c.type)return void p({title:"Invalid File Type",description:"Please upload a PDF file",variant:"destructive"});w(c),u(!0);try{console.log("[v0] ================================================"),console.log("[v0] STARTING CUSTOM TENDER UPLOAD PROCESS"),console.log("[v0] ================================================"),console.log("[v0] File name:",c.name),console.log("[v0] File size:",(c.size/1024/1024).toFixed(2),"MB"),console.log("[v0] Step 1: Uploading PDF to Supabase storage...");let b=new FormData;b.append("file",c);let d=await r(b);if(!d.success||!d.url)throw Error(d.error||"Failed to upload file");console.log("[v0] ✓ File uploaded successfully"),console.log("[v0] URL:",d.url),y(d.url);let e=d.url;p({title:"Analyzing Document",description:"AI is reading and analyzing your tender document..."}),console.log("[v0] Step 2: Sending PDF to AI for direct analysis..."),console.log("[v0] Requesting analysis via API...");let f=await fetch("/api/analyze-tender",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentUrl:e,documentText:""})});if(console.log("[v0] Analyze API response status:",f.status),!f.ok){let a=await f.json().catch(()=>({error:"Unknown error"}));throw console.error("[v0] ❌ Analysis API error:"),console.error("[v0] Status:",f.status),console.error("[v0] Error:",a),Error(a.error||a.details||`Analysis failed with status ${f.status}`)}let g=await f.json();console.log("[v0] ✓ Analysis complete successfully"),console.log("[v0] Analysis keys:",Object.keys(g)),console.log("[v0] Full analysis structure:",JSON.stringify(g,null,2)),console.log("[v0] Analysis has tender_summary:",!!g.tender_summary),console.log("[v0] Analysis has formFields:",g.formFields?.length||0),A(g),console.log("[v0] Step 3: Creating tender record with analysis...");let h=await q({title:g.tender_summary?.title||c.name.replace(".pdf",""),organization:g.tender_summary?.entity||"Unknown Organization",deadline:g.tender_summary?.closing_date||"",value:g.tender_summary?.contract_duration||"",description:g.tender_summary?.description||"",category:"Custom",uploadedFile:c,analysis:g});if(console.log("[v0] createCustomTender result:",h),h.success)console.log("[v0] ✓ Tender created successfully"),console.log("[v0] Tender ID:",h.tenderId),console.log("[v0] Orchestration ID:",h.orchestrationId),console.log("[v0] Document saved:",h.documentSaved),console.log("[v0] Analysis saved:",h.analysisSaved),h.documentError&&console.warn("[v0] Document error:",h.documentError),h.analysisError&&console.warn("[v0] Analysis error:",h.analysisError),F(h.tenderId),h.orchestrationId?(C(h.orchestrationId),p({title:"Tender Created Successfully",description:"Multi-engine analysis is running in the background..."})):(p({title:"Tender Created Successfully",description:"AI has analyzed your document and extracted all details."}),console.log("[v0] Redirecting to:",`/dashboard/tenders/${h.tenderId}`),a.push(`/dashboard/tenders/${h.tenderId}`));else throw console.error("[v0] ❌ Tender creation failed:",h.error),Error(h.error||"Failed to create tender")}catch(a){console.error("[v0] ================================================"),console.error("[v0] ❌ UPLOAD PROCESS FAILED"),console.error("[v0] ================================================"),console.error("[v0] Error:",a),console.error("[v0] Error message:",a.message),console.error("[v0] Error stack:",a.stack),p({title:"Upload Failed",description:a.message||"Could not process the document. Please try again.",variant:"destructive"}),w(null),y(null),A(null)}finally{u(!1)}}};return(0,b.jsxs)("div",{className:"p-6 md:p-8 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,b.jsx)(n.default,{href:"/dashboard/tenders",children:(0,b.jsx)(i.ArrowLeft,{className:"h-5 w-5"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Create New Tender"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Upload a tender document for automatic AI analysis"})]})]}),(0,b.jsxs)(e.Card,{className:"border-border max-w-3xl",children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Upload Tender Document"}),(0,b.jsx)(e.CardDescription,{children:"Upload a PDF tender document - AI will automatically analyze and extract all details"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(h.Label,{htmlFor:"pdf-upload",className:`flex items-center gap-2 px-4 py-2 rounded-md cursor-pointer transition-colors ${t?"bg-muted text-muted-foreground cursor-not-allowed":"bg-primary text-primary-foreground hover:bg-primary/90"}`,children:[t?(0,b.jsx)(m.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(j.Upload,{className:"h-4 w-4"}),t?"Processing...":v?"Change Document":"Upload PDF"]}),(0,b.jsx)(g.Input,{id:"pdf-upload",type:"file",accept:"application/pdf",onChange:G,className:"hidden",disabled:t}),v&&!t&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(k.FileText,{className:"h-4 w-4"}),v.name]})]}),t&&(0,b.jsxs)(o.Alert,{className:"border-blue-500/50 bg-blue-500/10",children:[(0,b.jsx)(m.Loader2,{className:"h-4 w-4 text-blue-500 animate-spin"}),(0,b.jsx)(o.AlertDescription,{className:"text-blue-500",children:"Processing your tender document... This may take a moment."})]}),v&&!t&&z&&!B&&(0,b.jsxs)(o.Alert,{className:"border-green-500/50 bg-green-500/10",children:[(0,b.jsx)(l.CheckCircle2,{className:"h-4 w-4 text-green-500"}),(0,b.jsx)(o.AlertDescription,{className:"text-green-500",children:"Document analyzed successfully! AI has extracted all tender details."})]})]})})]}),B&&E&&(0,b.jsxs)("div",{className:"max-w-3xl space-y-4",children:[(0,b.jsx)(D,{orchestrationId:B,onComplete:()=>{p({title:"Analysis Complete",description:"All AI engines have finished processing your tender."}),setTimeout(()=>{a.push(`/dashboard/tenders/${E}`)},2e3)}}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"You can navigate away - analysis will continue in the background"}),(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>a.push(`/dashboard/tenders/${E}`),children:"View Tender Details"})]})]})]})}a.s(["default",()=>F],25613)}];

//# sourceMappingURL=app_dashboard_tenders_new_page_tsx_3e26d3fe._.js.map